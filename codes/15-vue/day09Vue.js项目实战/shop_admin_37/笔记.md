# 启动项目

## 打开数据库服务器，打开 phpStudy

## 导入数据库

1. 打开 navicat，点击连接，创建一个 MySql 连接
2. 用户名和密码:root/root(不能乱写)，这个和 config 的配置一样
3. 创建数据库:shop_admin(不要乱写)，选择倒数找到 utf-8
4. 双击打开数据库
5. 导入 sql 语句，右键运行 sql 文件，shop-api 最后一个 sql 文件
   ![数据库表结构]("https://github.com/ZhangKuixun/heima/blob/master/codes/15-vue/day09Vue.js项目实战/shop_admin_37/notes_images/数据库表结构.png" "数据库表结构.png")

## 开启接口服务器

1. 打开 shop-api
2. 运行 npm start
3. 显示成功:API 接口服务器启动成功，占用端口 8888

## 使用

1. 每次都要先开启 phpStudy 中的 mySql
2. 每次都要打开 shop-api，运行 npm start

# 使用脚手架初始化项目

1. vue init wepback shop_admin_37
2. npm run dev

# 把没用的删除掉

> hello word 删除这个组件

# 配置路由

1. 安装路由`npm i vue-router`
2. 创建一个 `router/router.js`
3. 步骤

- 引入

```js
import Vue from "vue";
import VueRouter from "vue-router";
// 在模块化工厂中实例化
Vue.use(VueRouter);
```

- 实例化
  `const router = new VueRouter()`

- 导出
  `export default router`

4. 在`main.js`中引入并挂载
   ```js
    import router from "./router/router.js"
    router 放到 vue 实例里
   ```

# 创建两个组件 login、home，根据路由规则显示出来

1. 创建两个组件（单文件组件）Login.vue、Home.vue
2. 按照四个步骤：

- 入口
- 规则
- 组件
- 出口

# Element 基本使用

> 官网：https://element.eleme.cn/#/zh-CN/
>
> 1. 安装：npm i element-ui -S
> 2. 快速上手：完整引入

```js
main.js;
// 引入 element-ui
import ElementUI from "element-ui";
import "element-ui/lib/theme-chalk/index.css";

Vue.config.productionTip = false;

Vue.use(ElementUI);
```

> 3. 使用：拷贝官网组件的代码

# login 页=>登录表单组件

1. 居中

- 外面 el-rou el-col
- <el-row type="flex" justify="center" align="middle">
    <el-col :span='8'></el-col>
  </el-rou>
- 垂直没有居中，因为 el-row 高度就这么高
- html,body,#app,.el-row{height:100%}

# 开始登录

1. 安装 axios
2. 引入
3. 请求
4. 提示
5. 跳转

# scoped

> 作用：当前组件内的样式，只会对当前组件内的标签或者子组件起效果
> 问题：login 页和 home 页都有一个 h1 标签，然后再 login 页面设置 h1 为红色，home 页的 h1 也变色了
> 原因：组件内的样式进行了共享
> 解决办法：<style scoped></style>

> 原理：

1. 在 dom 上添加了自定义属性 data-v-唯一值：
   login: <h1 data-v-09b4fdc3></h1>
   home: <h1 data-v-dd7a443a></h1>
2. 设置样式：通过属性选择器，来设置样式
   login: h1[data-v-09b4fdc3]{color:red}
   home: h1[data-v-dd7a443a]{color:red}

> 不良反应：因为当前组件内的样式，只会对当前组件内的标签或者子组件起效果，html,body 不属于当前组件内的标签，可以设置为全局的

# Container 布局容器

# 登录问题

问题 1. 如何判断登录还是未登录？

- 如果登录成功了，后台会返回一个 token 令牌
- 保存到本地
- 获取 token 令牌，有 token 就是登录过，没有，就没有登录

```js
// 保存
localStorage.setItem("token", res.data.data.token);

// 获取
localStorage.getItem("token");
```

问题 2：如果未登录，访问了其他页面，该怎么处理？

- 判断到第登录了还是没有登录
- 全局前置导航守卫，登录拦截

- 处理步骤：

1. 判断是否是 login 页面 => 直接访问
2. 不是登录页面 => 再次判断
3. 跳转其他页面 => 判断是否登录 => 登录了 => 访问
   ===========================> 未登录 => 跳转 login

# 首页的退出

```js
 <el-button type="text" @click="logout">退出</el-button>

  <script>
  /* eslint-disable */
  export default {
    methods: {
      logout() {
        this.$confirm("此操作将退出该账户, 是否继续?", "提示", {
          confirmButtonText: "确定",
          cancelButtonText: "取消",
          type: "warning"
        })
          .then(() => {
            // 点击确定
            // 1. 清除token
            localStorage.removeItem("token");
            // 2. 提示
            this.$message({
              type: "success",
              message: "退出成功"
            });
            // 3.退出到登录页面
            this.$router.push("/login");
          })
          .catch(() => {
            // 点击取消
            this.$message({
              type: "info",
              message: "取消退出"
            });
          });
      }
    }
  }
  </script>
```

# 导航菜单

> 导航菜单的路由
> el-menu 有个属性 router 默认是‘false’，开启 vue-router 路由模式=>true
> index 的值作为 path 进行路由跳转

- el-menu 菜单组件
- default-active="1" 默认选中，默认高亮(index:2)
- @open="handleOpen" 打开
- @close="handleClose" 关闭
- el-submenu 菜单子组件(可展开)
- el-menu-item 菜单元素(最小单位)
- el-menu-item-group 分组
- :router="true" 是否打开路由模式

```js
<el-aside width="200px">
  <el-menu
    :router="true"
    default-active="1"
    class="el-menu-vertical-demo"
    @open="handleOpen"
    @close="handleClose"
    background-color="#545c64"
    text-color="#fff"
    active-text-color="#ffd04b"
  >
    <!--用户管理  -->
    <el-submenu index="1">
      <template slot="title">
        <i class="el-icon-location"></i>
        <span>用户管理</span>
      </template>
      <el-menu-item index="users">用户列表</el-menu-item>
    </el-submenu>
    <!-- 权限管理 -->
    <el-submenu index="2">
      <template slot="title">
        <i class="el-icon-location"></i>
        <span>权限管理</span>
      </template>
      <el-menu-item index="2-1">角色列表</el-menu-item>
      <el-menu-item index="2-2">权限列表</el-menu-item>
    </el-submenu>
  </el-menu>
</el-aside>
```

# 创建三个组件 并且显示出来

1. 创建组件 users/Users.vue
2. 在 router.js 创建导航规则

- 入口 - 规则 - 组件 - 出口

3. 需求：users /roles/rights 三个对应的组件显示在 home 组件里，不能把 home 给替换掉
4. 嵌套路由(子路由)

- home 组件里留一个出口
- 设置子路由 children:[三个路由规则]

```js
home.vue
<el-main>
  <!-- 子组件的出口 -->
  <router-view></router-view>
</el-main>

router.js
routes: [
  {
    path: "/home",
    name: "home",
    component: Home,
    children: [
      { path: "/users", name: "users", component: Users },
      { path: "/roles", name: "roles", component: Roles },
      { path: "/rights", name: "rights", component: Rights }
    ]
  }
];
```

# 用户列表

1. element-ui 把`数据+结构`拷贝过来
